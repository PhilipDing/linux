webpackJsonp([218],{1293:function(e,n){e.exports={render:function(){var e=this,n=e.$createElement;e._self._c;return e._m(0)},staticRenderFns:[function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("section",[t("p",[t("strong",[e._v("partprobe命令")]),e._v("用于重读分区表，当出现删除文件后，出现仍然占用空间。可以partprobe在不重启的情况下重读分区。")]),e._v(" "),t("h3",[e._v("语法")]),e._v(" "),t("pre",{pre:!0},[t("code",{attrs:{"v-pre":""}},[e._v("partprobe(选项)(参数)\n")])]),e._v(" "),t("h3",[e._v("选项")]),e._v(" "),t("pre",{pre:!0},[t("code",{attrs:{"v-pre":""}},[e._v("-d：不更新内核；\n-s：显示摘要和分区；\n-h：显示帮助信息；\n-v：显示版本信息。\n")])]),e._v(" "),t("h3",[e._v("参数")]),e._v(" "),t("p",[e._v("设备：指定需要确认分区表改变的硬盘对应的设备文件。")]),e._v(" "),t("h3",[e._v("实例")]),e._v(" "),t("p",[e._v("使用partprobe不重启系统添加新的磁盘分区，主机自带硬盘超过300GB，目前只划分使用了3个主分区，不到70GB，如下：")]),e._v(" "),t("pre",{pre:!0},[t("code",{attrs:{"v-pre":""}},[e._v('[root@localhost ~]# [df](#/df "df命令") -h \nFilesystem Size Used Avail Use% Mounted on \n/dev/sda1 29G 3.7G  24G 14% / \n/dev/sda2 29G  22G 5.2G 81% /oracle \ntmpfs    2.0G    0 2.0G  0% /dev/shm\n')])]),e._v(" "),t("pre",{pre:!0},[t("code",{attrs:{"v-pre":""}},[e._v('[root@localhost ~]# [cat](#/cat "cat命令") /proc/partitions\nmajor minor  #blocks  name\n\n   8     0  311427072 sda\n   8     1   30716248 sda1\n   8     2   30716280 sda2\n   8     3    8193150 sda3\n   8    16     976896 sdb\n   8    32     976896 sdc\n\n…省略其他\n\n')])]),e._v(" "),t("p",[e._v("现在需要给系统添加1个100GB的空间存放数据文件，而又不影响现有系统上业务的运行，使用"),t("a",{attrs:{href:"#/fdisk",title:"fdisk命令"}},[e._v("fdisk")]),e._v("结合partprobe命令不重启系统添加一块新的磁盘分区。操作步骤如下：")]),e._v(" "),t("p",[t("strong",[e._v("第1步 添加新的磁盘分区")]),e._v("：")]),e._v(" "),t("pre",{pre:!0},[t("code",{attrs:{"v-pre":""}},[e._v('[root@localhost ~]# fdisk /dev/sda\nThe number of cylinders for this disk is [set](#/set "set命令") to 38770.\nThere is nothing wrong with that, but this is larger than 1024,\nand could in certain setups cause problems with:\n1) software that runs [at](#/at "at命令") boot [time](#/time "time命令") (e.g., old versions of [lilo](#/lilo "lilo命令"))\n2) booting and partitioning software from other OSs\n   (e.g., DOS FDISK, OS/2 FDISK)\n\n[command](#/command "command命令") (m for [help](#/help "help命令")): p\n\nDisk /dev/sda: 318.9 GB, 318901321728 bytes\n255 heads, 63 sectors/track, 38770 cylinders\nUnits = cylinders of 16065 * 512 = 8225280 bytes\n\n   Device Boot      Start         End      Blocks   [id](#/id "id命令")  System\n/dev/sda1   *           1        3824    30716248+  83  Linux\n/dev/sda2            3825        7648    30716280   83  Linux\n/dev/sda3            7649        8668     8193150   82  Linux swap / Solaris\n\nCommand (m for help): n\nCommand action\n   e   extended\n   p   primary partition (1-4)\np\nSelected partition 4\nFirst cylinder (8669-38770, default 8669):\nUsing default value 8669\n[last](#/last "last命令") cylinder or +size or +sizeM or +sizeK (8669-38770, default 38770): +100G   \nCommand (m for help): [w](#/w "w命令")\nThe partition table has been altered!\n\nCalling ioctl() to re-[read](#/read "read命令") partition table.\n\nWARNING: Re-reading the partition table failed with error 16: \n\nDevice or resource busy.\nThe kernel still uses the old table.\nThe new table will be used at the next [reboot](#/reboot "reboot命令").\nSyncing disks.\n')])]),e._v(" "),t("p",[t("strong",[e._v("第2步 使用工具partprobe让kernel读取分区信息：")])]),e._v(" "),t("pre",{pre:!0},[t("code",{attrs:{"v-pre":""}},[e._v("[root@localhost ~]# partprobe\n")])]),e._v(" "),t("p",[e._v("使用fdisk工具只是将分区信息写到磁盘，如果需要"),t("a",{attrs:{href:"#/mkfs",title:"mkfs命令"}},[e._v("mkfs")]),e._v("磁盘分区则需要重启系统，而使用partprobe则可以使kernel重新读取分区信息，从而避免重启系统。")]),e._v(" "),t("p",[t("strong",[e._v("第3步 格式化文件系统：")])]),e._v(" "),t("pre",{pre:!0},[t("code",{attrs:{"v-pre":""}},[e._v('[root@localhost ~]# mkfs.ext3 /dev/sda4\n[mke2fs](#/mke2fs "mke2fs命令") 1.39 (29-May-2006)\nFilesystem label=\nOS [type](#/type "type命令"): Linux\nBlock size=4096 (log=2)\nFragment size=4096 (log=2)\n12222464 inodes, 24416791 blocks\n1220839 blocks (5.00%) reserved for the super user\nFirst data block=0\nMaximum filesystem blocks=4294967296\n746 block [groups](#/groups "groups命令")\n32768 blocks per group, 32768 fragments per group\n16384 inodes per group\nSuperblock backups stored on blocks:\n        32768, 98304, 163840, 229376, 294912, 819200, 884736, 1605632, \n　　　　2654208, 4096000, 7962624, 11239424, 20480000, 23887872\n\nWriting inode tables: done\nCreating journal (32768 blocks): done\nWriting superblocks and filesystem accounting information:\n\ndone\n\nThis filesystem will be automatically checked every 26 mounts or\n180 days, whichever comes first.  Use [tune2fs](#/tune2fs "tune2fs命令") -c or -i to override.\n[root@localhost ~]#\n')])]),e._v(" "),t("p",[t("strong",[e._v("第4步 "),t("a",{attrs:{href:"#/mount",title:"mount命令"}},[e._v("mount")]),e._v("新的分区"),t("code",{pre:!0},[e._v("/dev/sda4")]),e._v("：")])]),e._v(" "),t("pre",{pre:!0},[t("code",{attrs:{"v-pre":""}},[e._v('[root@localhost ~]# [e2label](#/e2label "e2label命令")  /dev/sda4 /data\n[root@localhost ~]# [mkdir](#/mkdir "mkdir命令") /data\n[root@localhost ~]# mount /dev/sda4 /data\n[root@localhost ~]# df\nFilesystem           1K-blocks      Used Available Use% Mounted on\n/dev/sda1             29753556   3810844  24406900  14% /\n/dev/sda2             29753588  11304616  16913160  41% /oracle\ntmpfs                  2023936         0   2023936   0% /dev/shm\n/dev/sda4             96132968    192312  91057300   1% /data\n')])]),e._v(" "),t("p",[e._v("使用partprobe可以不用重启系统即可配合fdisk工具创建新的分区。")])])}]}},336:function(e,n,t){e.exports=t(925)},925:function(e,n,t){var o=t(5)(null,t(1293),null,null,null);e.exports=o.exports}});
//# sourceMappingURL=218.eaa462f0c75f9498d6de.js.map